<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keml Shop</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8f9fa;
            background-image: url('images/fon.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #212529;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background-color: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
        }

        .logo img {
            height: 50px;
            margin-right: 10px;
        }

        .logo-text {
            font-size: 2rem;
            font-weight: bold;
            color: #ffffff;
        }

        .nav-menu {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-menu a {
            color: #ffffff;
            text-decoration: none;
            transition: color 0.3s;
            cursor: pointer;
        }

        .nav-menu a:hover {
            color: #3b82f6;
        }

        /* –ë—É—Ä–≥–µ—Ä-–º–µ–Ω—é */
        .burger {
            display: none;
            flex-direction: column;
            justify-content: space-between;
            width: 30px;
            height: 21px;
            cursor: pointer;
            z-index: 101;
        }

        .burger span {
            display: block;
            height: 3px;
            width: 100%;
            background-color: #ffffff;
            border-radius: 3px;
            transition: all 0.3s ease-in-out;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –±—É—Ä–≥–µ—Ä–∞ –≤ –∫—Ä–µ—Å—Ç–∏–∫ */
        .burger.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .burger.active span:nth-child(2) {
            opacity: 0;
        }

        .burger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        /* –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é */
        .mobile-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
        }

        .mobile-menu.active {
            transform: translateX(0);
        }

        .mobile-menu ul {
            list-style: none;
            text-align: center;
        }

        .mobile-menu li {
            margin: 1.5rem 0;
        }

        .mobile-menu a {
            color: #ffffff;
            text-decoration: none;
            font-size: 1.5rem;
            transition: color 0.3s;
        }

        .mobile-menu a:hover {
            color: #3b82f6;
        }

        /* –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é */
        .close-menu {
            position: absolute;
            top: 2rem;
            right: 2rem;
            font-size: 2rem;
            color: #ffffff;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close-menu:hover {
            color: #3b82f6;
        }

        main {
            flex: 1;
            padding: 2rem 0;
        }

        .hero {
            text-align: center;
            padding: 4rem 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 249, 250, 0.8) 100%);
            border-radius: 1rem;
            margin-bottom: 3rem;
            border: 1px solid rgba(233, 236, 239, 0.7);
            backdrop-filter: blur(5px);
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #000000;
            font-weight: bold;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            color: #000000;
        }

        .btn {
            background-color: #3b82f6;
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background-color: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        .btn-danger {
            background-color: #ef4444;
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .btn-success {
            background-color: #10b981;
        }

        .btn-success:hover {
            background-color: #059669;
        }

        .btn-warning {
            background-color: #f59e0b;
        }

        .btn-warning:hover {
            background-color: #d97706;
        }

        .search-container {
            margin-bottom: 2rem;
            display: flex;
            gap: 1rem;
        }

        .search-input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #ced4da;
            border-radius: 0.5rem;
            font-size: 1rem;
        }

        .sort-container {
            margin-bottom: 2rem;
        }

        .sort-select {
            padding: 0.75rem;
            border: 1px solid #ced4da;
            border-radius: 0.5rem;
            font-size: 1rem;
            background-color: white;
        }

        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .category-card {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        .category-card:hover {
            transform: translateY(-5px);
            border-color: #3b82f6;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.15);
        }

        .category-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .category-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 1rem;
            border: 2px solid #e9ecef;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .product-card {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 1rem;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-name {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: #212529;
        }

        .product-price {
            font-size: 1.5rem;
            color: #3b82f6;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            background-color: rgba(233, 236, 239, 0.9);
            color: #495057;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }

        .filter-btn.active {
            background-color: #3b82f6;
            color: white;
        }

        .filter-btn:hover {
            background-color: rgba(222, 226, 230, 0.9);
        }

        .filter-btn.active:hover {
            background-color: #2563eb;
        }

        .subcategories {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .subcategory-btn {
            background-color: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border: 1px solid #3b82f6;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .subcategory-btn:hover {
            background-color: rgba(59, 130, 246, 0.2);
        }

        .subcategory-btn.active {
            background-color: #3b82f6;
            color: white;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 2rem;
        }

        .pagination button {
            padding: 0.5rem 1rem;
            border: 1px solid #ced4da;
            background-color: white;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pagination button:hover {
            background-color: #e9ecef;
        }

        .pagination button.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .product-detail {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 1rem;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        .product-detail-image {
            width: 100%;
            border-radius: 1rem;
            border: 1px solid #e9ecef;
        }

        .product-detail-info h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #212529;
        }

        .product-detail-price {
            font-size: 2rem;
            color: #3b82f6;
            margin-bottom: 1rem;
        }

        .product-description {
            margin-bottom: 1.5rem;
            line-height: 1.6;
            color: #495057;
        }

        .characteristics {
            list-style: none;
            margin-bottom: 2rem;
        }

        .characteristics li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e9ecef;
            color: #495057;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .quantity-btn {
            background-color: #e9ecef;
            color: #495057;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        .quantity-btn:hover {
            background-color: #dee2e6;
        }

        .quantity-input {
            background-color: #f8f9fa;
            color: #212529;
            border: 1px solid #ced4da;
            width: 60px;
            height: 40px;
            text-align: center;
            border-radius: 0.5rem;
            font-size: 1rem;
        }

        .reviews-section {
            margin-top: 2rem;
        }

        .review-item {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(233, 236, 239, 0.7);
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .review-rating {
            color: #ffc107;
        }

        .cart-item {
            display: grid;
            grid-template-columns: 100px 1fr auto auto auto;
            gap: 1rem;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 1rem;
            border-radius: 1rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        .cart-item-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 0.5rem;
            border: 1px solid #e9ecef;
        }

        .cart-item-name {
            font-weight: 500;
            color: #212529;
        }

        .cart-item-price {
            color: #3b82f6;
            font-weight: bold;
        }

        .cart-quantity {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .cart-total {
            text-align: right;
            font-size: 1.5rem;
            margin: 2rem 0;
            color: #3b82f6;
        }

        .order-form {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 1rem;
            margin-top: 2rem;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #6c757d;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            background-color: rgba(248, 249, 250, 0.9);
            border: 1px solid #ced4da;
            border-radius: 0.5rem;
            color: #212529;
            font-size: 1rem;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .age-confirmation {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background-color: rgba(239, 68, 68, 0.1);
            border-radius: 0.5rem;
            border-left: 4px solid #ef4444;
        }

        .age-confirmation input[type="checkbox"] {
            width: auto;
            margin-right: 0.75rem;
            transform: scale(1.2);
        }

        .age-confirmation label {
            margin-bottom: 0;
            color: #212529;
            font-weight: 500;
            cursor: pointer;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 1.5rem;
            border-radius: 1rem;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        .stat-card h3 {
            margin-bottom: 0.5rem;
            color: #495057;
        }

        .stat-card p {
            font-size: 1.5rem;
            font-weight: bold;
            color: #3b82f6;
        }

        .admin-products-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .admin-product-card {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 1.5rem;
            border-radius: 1rem;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        .admin-product-card h4 {
            margin-bottom: 0.5rem;
            color: #212529;
        }

        .admin-product-card p {
            margin-bottom: 0.5rem;
            color: #6c757d;
        }

        .admin-product-card .admin-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .orders-table {
            width: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 1rem;
            overflow: hidden;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        .orders-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .orders-table th,
        .orders-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(233, 236, 239, 0.7);
        }

        .orders-table th {
            background-color: rgba(59, 130, 246, 0.1);
            font-weight: 600;
            color: #3b82f6;
        }

        .orders-table tr:hover {
            background-color: rgba(59, 130, 246, 0.05);
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .status-new {
            background-color: #dbeafe;
            color: #1d4ed8;
        }

        .status-processing {
            background-color: #fef3c7;
            color: #d97706;
        }

        .status-completed {
            background-color: #d1fae5;
            color: #059669;
        }

        .status-cancelled {
            background-color: #fee2e2;
            color: #dc2626;
        }

        footer {
            background-color: rgba(0, 0, 0, 0.9);
            padding: 2rem 0;
            margin-top: auto;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            color: #ffffff;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .footer-content p {
            color: #ffffff;
        }

        .age-warning {
            color: #ef4444;
            font-weight: bold;
            margin-top: 10px;
        }

        .telegram-btn {
            background-color: #0088cc;
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.3s;
            display: inline-block;
            margin-bottom: 0.5rem;
        }

        .telegram-btn:hover {
            background-color: #0077b3;
            transform: translateY(-2px);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: rgba(255, 255, 255, 0.95);
            padding: 3rem;
            border-radius: 1rem;
            text-align: center;
            max-width: 600px;
            width: 90%;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            backdrop-filter: blur(5px);
        }

        .modal-content h2 {
            margin-bottom: 1.5rem;
            color: #212529;
        }

        .modal-content p {
            margin-bottom: 1.5rem;
            line-height: 1.6;
            color: #495057;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .edit-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1001;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
        }

        .edit-modal-content {
            background-color: rgba(255, 255, 255, 0.95);
            padding: 2rem;
            border-radius: 1rem;
            max-width: 600px;
            width: 90%;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            backdrop-filter: blur(5px);
        }

        .edit-modal-content h2 {
            margin-bottom: 1.5rem;
            color: #212529;
        }

        .edit-modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
        }

        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background-color: #10b981;
            color: white;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateX(400px);
            transition: transform 0.3s;
            z-index: 1002;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            background-color: #ef4444;
        }

        @media (max-width: 768px) {
            .burger {
                display: flex;
            }

            .nav-menu {
                display: none;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .product-detail {
                grid-template-columns: 1fr;
            }

            .cart-item {
                grid-template-columns: 80px 1fr;
                gap: 0.5rem;
            }

            .cart-item-price,
            .cart-quantity {
                grid-column: 2;
            }

            .footer-content {
                flex-direction: column;
                text-align: center;
            }

            .orders-table {
                font-size: 0.875rem;
            }

            .orders-table th,
            .orders-table td {
                padding: 0.5rem;
            }

            .edit-modal-content {
                padding: 1.5rem;
            }

            .categories {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }

            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }

            .product-detail {
                gap: 1.5rem;
            }

            .filters {
                justify-content: center;
            }

            .filter-btn {
                flex: 1;
                min-width: 120px;
            }
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hidden {
            display: none !important;
        }

        .apple-categories {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .apple-categories .btn {
            min-width: 150px;
        }

        .about-section {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 1rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(233, 236, 239, 0.7);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        .about-section h2 {
            color: #212529;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }

        .about-section h3 {
            color: #3b82f6;
            margin: 1.5rem 0 1rem;
            font-size: 1.3rem;
        }

        .about-section p {
            line-height: 1.6;
            margin-bottom: 1rem;
            color: #495057;
        }

        .about-section ul {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        .about-section li {
            margin-bottom: 0.5rem;
            color: #495057;
        }

        .contact-info {
            background-color: rgba(59, 130, 246, 0.1);
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-top: 1.5rem;
        }

        .contact-info p {
            margin-bottom: 0.5rem;
            color: #212529;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <a href="#" class="logo" onclick="showPage('home')">
                    <img src="images/llogo1.png" alt="KEML Logo">
                    <div class="logo-text">KEML</div>
                </a>
                
                <!-- –ë—É—Ä–≥–µ—Ä-–º–µ–Ω—é –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
                <div class="burger" onclick="toggleMobileMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                
                <ul class="nav-menu">
                    <li><a onclick="showPage('home')">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a onclick="showPage('catalog')">–ö–∞—Ç–∞–ª–æ–≥</a></li>
                    <li><a onclick="showPage('apple-tech')">Apple —Ç–µ—Ö–Ω–∏–∫–∞</a></li>
                    <li><a onclick="showPage('about')">–û –Ω–∞—Å</a></li>
                    <li><a onclick="showPage('cart')">–ö–æ—Ä–∑–∏–Ω–∞ (<span id="cart-count">0</span>)</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
    <div class="mobile-menu" id="mobile-menu">
        <div class="close-menu" onclick="toggleMobileMenu()">‚úï</div>
        <ul>
            <li><a onclick="showPage('home'); toggleMobileMenu()">–ì–ª–∞–≤–Ω–∞—è</a></li>
            <li><a onclick="showPage('catalog'); toggleMobileMenu()">–ö–∞—Ç–∞–ª–æ–≥</a></li>
            <li><a onclick="showPage('apple-tech'); toggleMobileMenu()">Apple —Ç–µ—Ö–Ω–∏–∫–∞</a></li>
            <li><a onclick="showPage('about'); toggleMobileMenu()">–û –Ω–∞—Å</a></li>
            <li><a onclick="showPage('cart'); toggleMobileMenu()">–ö–æ—Ä–∑–∏–Ω–∞ (<span id="mobile-cart-count">0</span>)</a></li>
        </ul>
    </div>

    <main>
        <div class="container">
            <div id="home-page" class="page active">
                <section class="hero">
                    <h1>Keml Shop</h1>
                    <p>–õ—É—á—à–∏–µ —Ç–æ–≤–∞—Ä—ã –¥–ª—è –≤–µ–π–ø–∏–Ω–≥–∞ –∏ Apple —Ç–µ—Ö–Ω–∏–∫–∏</p>
                    <br>
                    <button class="btn" onclick="showPage('catalog')">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥</button>
                </section>

                <section class="categories">
                    <div class="category-card" onclick="goToCategory('–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã')">
                        <img src="images/kml odn.jpg" alt="–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã" class="category-image">
                        <h3>–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã</h3>
                    </div>
                    <div class="category-card" onclick="goToCategory('–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞')">
                        <img src="images/kml jij.jpg" alt="–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞" class="category-image">
                        <h3>–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞</h3>
                    </div>
                    <div class="category-card" onclick="goToCategory('Pod-—Å–∏—Å—Ç–µ–º—ã')">
                        <img src="images/kml pod.jpg" alt="Pod-—Å–∏—Å—Ç–µ–º—ã" class="category-image">
                        <h3>Pod-—Å–∏—Å—Ç–µ–º—ã</h3>
                    </div>
                    <div class="category-card" onclick="goToCategory('–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏')">
                        <img src="images/kml krdjpg.jpg" alt="–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏" class="category-image">
                        <h3>–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏</h3>
                    </div>
                    <div class="category-card" onclick="goToCategory('–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫')">
                        <img src="images/kml snu.jpg" alt="–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫" class="category-image">
                        <h3>–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫</h3>
                    </div>
                    <div class="category-card" onclick="goToCategory('–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –ø—Ä–æ—á–µ–µ')">
                        <div class="category-icon">üîß</div>
                        <h3>–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –ø—Ä–æ—á–µ–µ</h3>
                    </div>
                    <div class="category-card" onclick="showPage('apple-tech')">
                        <img src="images/app.jpg" alt="Apple —Ç–µ—Ö–Ω–∏–∫–∞" class="category-image">
                        <h3>Apple —Ç–µ—Ö–Ω–∏–∫–∞</h3>
                    </div>
                </section>
            </div>

            <div id="catalog-page" class="page">
                <h2 style="margin-bottom: 2rem; color: #ffffff;">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h2>
                
                <div class="search-container">
                    <input type="text" id="search-input" class="search-input" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." onkeyup="searchProducts()">
                    <button class="btn" onclick="clearSearch()">–û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>
                
                <div class="sort-container">
                    <label for="sort-select">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
                    <select id="sort-select" class="sort-select" onchange="sortProducts()">
                        <option value="default">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</option>
                        <option value="price-asc">–¶–µ–Ω–∞: –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
                        <option value="price-desc">–¶–µ–Ω–∞: –ø–æ —É–±—ã–≤–∞–Ω–∏—é</option>
                        <option value="name">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é</option>
                    </select>
                </div>
                
                <div class="filters">
                    <button class="filter-btn active" onclick="filterByCategory('all')">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</button>
                    <button class="filter-btn" onclick="filterByCategory('–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã')">–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã</button>
                    <button class="filter-btn" onclick="filterByCategory('–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞')">–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞</button>
                    <button class="filter-btn" onclick="filterByCategory('Pod-—Å–∏—Å—Ç–µ–º—ã')">Pod-—Å–∏—Å—Ç–µ–º—ã</button>
                    <button class="filter-btn" onclick="filterByCategory('–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏')">–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏</button>
                    <button class="filter-btn" onclick="filterByCategory('–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫')">–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫</button>
                    <button class="filter-btn" onclick="filterByCategory('–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –ø—Ä–æ—á–µ–µ')">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –ø—Ä–æ—á–µ–µ</button>
                    <button class="filter-btn" onclick="filterByCategory('Apple —Ç–µ—Ö–Ω–∏–∫–∞')">Apple —Ç–µ—Ö–Ω–∏–∫–∞</button>
                </div>

                <div id="snus-subcategories" class="subcategories hidden">
                    <button class="subcategory-btn active" onclick="filterBySubcategory('all')">–í—Å–µ</button>
                    <button class="subcategory-btn" onclick="filterBySubcategory('–ë–µ—Å—Ç–∞–±–∞—á–Ω—ã–π')">–ë–µ—Å—Ç–∞–±–∞—á–Ω—ã–π</button>
                    <button class="subcategory-btn" onclick="filterBySubcategory('–¢–∞–±–∞—á–Ω—ã–π')">–¢–∞–±–∞—á–Ω—ã–π</button>
                </div>

                <div id="products-grid" class="products-grid"></div>
                <div id="pagination" class="pagination"></div>
            </div>

            <div id="product-page" class="page">
                <button class="btn" onclick="showPage('catalog')" style="margin-bottom: 2rem;">‚Üê –ù–∞–∑–∞–¥ –≤ –∫–∞—Ç–∞–ª–æ–≥</button>
                <div id="product-detail" class="product-detail"></div>
                
                <div class="reviews-section">
                    <h3>–û—Ç–∑—ã–≤—ã</h3>
                    <div id="reviews-list"></div>
                    <form id="add-review-form" style="margin-top: 1rem;">
                        <div class="form-group">
                            <input type="text" id="review-name" placeholder="–í–∞—à–µ –∏–º—è" required>
                        </div>
                        <div class="form-group">
                            <select id="review-rating">
                                <option value="5">5 –∑–≤–µ–∑–¥</option>
                                <option value="4">4 –∑–≤–µ–∑–¥—ã</option>
                                <option value="3">3 –∑–≤–µ–∑–¥—ã</option>
                                <option value="2">2 –∑–≤–µ–∑–¥—ã</option>
                                <option value="1">1 –∑–≤–µ–∑–¥–∞</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <textarea id="review-text" placeholder="–í–∞—à –æ—Ç–∑—ã–≤" rows="3" required></textarea>
                        </div>
                        <button type="submit" class="btn">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
                    </form>
                </div>
            </div>

            <div id="cart-page" class="page">
                <h2 style="margin-bottom: 2rem;">–ö–æ—Ä–∑–∏–Ω–∞</h2>
                <div id="cart-items"></div>
                <div id="cart-total" class="cart-total"></div>
                
                <div class="order-form">
                    <h3 style="margin-bottom: 1.5rem;">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
                    <form id="order-form">
                        <div class="form-group">
                            <label for="name">–§–ò–û</label>
                            <input type="text" id="name" required>
                        </div>
                        <div class="form-group">
                            <label for="telegram">Telegram –¥–ª—è —Å–≤—è–∑–∏</label>
                            <input type="text" id="telegram" placeholder="@username" required>
                        </div>
                        <div class="form-group">
                            <label for="city">–ì–æ—Ä–æ–¥</label>
                            <input type="text" id="city" required>
                        </div>
                        <div class="form-group">
                            <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                            <textarea id="comment" rows="3"></textarea>
                        </div>
                        
                        <div class="age-confirmation">
                            <input type="checkbox" id="age-confirm" required>
                            <label for="age-confirm">–Ø –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é, —á—Ç–æ –º–Ω–µ –µ—Å—Ç—å 18 –ª–µ—Ç</label>
                        </div>
                        
                        <button type="submit" class="btn">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
                    </form>
                </div>
            </div>

            <div id="apple-tech-page" class="page">
                <h2 style="margin-bottom: 2rem;">Apple —Ç–µ—Ö–Ω–∏–∫–∞</h2>
                
                <div class="apple-categories">
                    <button class="btn" onclick="showAppleCategory('iphones')">–ê–π—Ñ–æ–Ω—ã</button>
                    <button class="btn" onclick="showAppleCategory('macbooks')">–ú–∞–∫–±—É–∫–∏</button>
                    <button class="btn" onclick="showAppleCategory('ipads')">–ê–π–ø–∞–¥—ã</button>
                    <button class="btn" onclick="showAppleCategory('headphones')">–ù–∞—É—à–Ω–∏–∫–∏</button>
                </div>
                
                <div id="apple-products-grid" class="products-grid"></div>
            </div>

            <div id="about-page" class="page">
                <div class="about-section">
                    <h2>–û –∫–æ–º–ø–∞–Ω–∏–∏ Keml</h2>
                    <p>–û–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω keml, –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –Ω–∞ —Ä—ã–Ω–∫–µ —Å–µ–±—è –∫–∞–∫ –º–∞–≥–∞–∑–∏–Ω, –∫–æ—Ç–æ—Ä—ã–π —Ä–≤–µ—Ç —à–∞–±–ª–æ–Ω—ã –≤–∞—à–µ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ –æ–Ω–ª–∞–π–Ω-–∑–∞–∫–∞–∑–∞—Ö.</p>
                    
                    <h3>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ –º—ã, –∞ –Ω–µ –∫–∞–∫–æ–π-—Ç–æ –¥—Ä—É–≥–æ–π –º–∞–≥–∞–∑–∏–Ω?</h3>
                    <ul>
                        <li><strong>–ù–∞—à–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç—å –∏ —Å–∫–∏–¥–∫–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤</strong>, –¥–µ–ª–∞—é—Ç –Ω–∞—Å —Å–∞–º—ã–º –≤—ã–≥–æ–¥–Ω—ã–º –º–∞–≥–∞–∑–∏–Ω–æ–º –Ω–∞ —Ä—ã–Ω–∫–µ.</li>
                        <li><strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å</strong>. –ú—ã –¥–µ–ª–∞–µ–º –≤—Å–µ, —á—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–æ–≤–∞—Ä–∞ - 1 –¥–µ–Ω—å. –î–∞–ª—å—à–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—à–µ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –°–î–≠–ö –∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤–∞–º–∏ —Å–ø–æ—Å–æ–±–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏.</li>
                        <li><strong>–ë–æ–ª—å—à–æ–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç. –ë–æ–ª—å—à–∏–µ –≤—ã–≥–æ–¥—ã. –ë–æ–ª—å—à–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ</strong>. –≠—Ç–∏–º–∏ 3-–º—è –±–æ–ª—å—à–∏–º–∏ "–ë" –º–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å –º–∞–≥–∞–∑–∏–Ω keml.</li>
                        <li><strong>–ë—ã—Å—Ç—Ä–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</strong>. –ï—Å–ª–∏ —É –≤–∞—Å —Å–ª—É—á–∞–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–∞, –µ—Å—Ç—å –∂–µ–ª–∞–Ω–∏–µ –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å. –ù–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–≤–µ—Ç–∏—Ç –≤–∞–º –≤ —Ç–µ—á–µ–Ω–∏–∏ 15 –º–∏–Ω—É—Ç. –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç–∞ –Ω–µ –ø–æ—Å—Ç—É–ø–∏–ª–æ, –≤–∞–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ —Å–∫–∏–¥–∫–∞ –Ω–∞ –≤–∞—à –∑–∞–∫–∞–∑.</li>
                    </ul>
                    
                    <div class="contact-info">
                        <h3>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <p><strong>–°–∞–º–æ–≤—ã–≤–æ–∑:</strong> –≥.–ú–æ—Å–∫–≤–∞, –º.–õ—é–±–ª–∏–Ω–æ, –¢–∏—Ö–æ—Ä–µ—Ü–∫–∏–π –±-—Ä 1–∫33, –õ–∏–Ω–∏—è(–í) 1—Å—Ç12</p>
                        <p><strong>–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:</strong> 9:00-23:00 –ú–°–ö</p>
                        <p><strong>Telegram:</strong> <a href="https://t.me/keml_manager" target="_blank">@keml_manager</a></p>
                    </div>
                </div>
            </div>

            <div id="admin-page" class="page">
                <h2 style="margin-bottom: 2rem;">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
                
                <div class="admin-stats">
                    <div class="stat-card">
                        <h3>–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</h3>
                        <p id="total-orders">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</h3>
                        <p id="total-revenue">0‚ÇΩ</p>
                    </div>
                    <div class="stat-card">
                        <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h3>
                        <div id="popular-products"></div>
                    </div>
                </div>

                <div style="margin-bottom: 2rem;">
                    <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram</h3>
                    <form id="telegram-settings-form">
                        <div class="form-group">
                            <label for="telegram-token">–¢–æ–∫–µ–Ω –±–æ—Ç–∞</label>
                            <input type="text" id="telegram-token" placeholder="1234567890:ABCdefGhIjKlMnOpQrStUvWxYz">
                        </div>
                        <div class="form-group">
                            <label for="telegram-chat-ids">Chat ID (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                            <input type="text" id="telegram-chat-ids" placeholder="123456789,987654321">
                        </div>
                        <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                    </form>
                </div>

                <div style="margin-bottom: 2rem;">
                    <h3>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
                    <button class="btn" onclick="testTelegramNotification()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</button>
                </div>

                <div style="margin-bottom: 2rem;">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</h3>
                    <div class="orders-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ö–ª–∏–µ–Ω—Ç</th>
                                    <th>Telegram</th>
                                    <th>–°—É–º–º–∞</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="orders-tbody"></tbody>
                        </table>
                    </div>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h3>
                    <form id="add-product-form">
                        <div class="form-group">
                            <label for="product-name">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                            <input type="text" id="product-name" required>
                        </div>
                        <div class="form-group">
                            <label for="product-category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                            <select id="product-category" required onchange="updateSubcategoryOptions()">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                <option value="–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã">–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã</option>
                                <option value="–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞">–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞</option>
                                <option value="Pod-—Å–∏—Å—Ç–µ–º—ã">Pod-—Å–∏—Å—Ç–µ–º—ã</option>
                                <option value="–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏">–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏</option>
                                <option value="–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫">–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫</option>
                                <option value="–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –ø—Ä–æ—á–µ–µ">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –ø—Ä–æ—á–µ–µ</option>
                                <option value="Apple —Ç–µ—Ö–Ω–∏–∫–∞">Apple —Ç–µ—Ö–Ω–∏–∫–∞</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="product-subcategory">–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                            <select id="product-subcategory">
                                <option value="">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="product-price">–¶–µ–Ω–∞</label>
                            <input type="number" id="product-price" required>
                        </div>
                        <div class="form-group">
                            <label for="product-image">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                            <input type="text" id="product-image" required>
                        </div>
                        <div class="form-group">
                            <label for="product-description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                            <textarea id="product-description" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                            <input type="text" id="product-characteristics">
                        </div>
                        <button type="submit" class="btn">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                    </form>
                </div>
                
                <div>
                    <h3>–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</h3>
                    <div id="admin-products-list" class="admin-products-list"></div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div>
                    <p>–ö–æ–Ω—Ç–∞–∫—Ç—ã: <a href="https://t.me/keml_manager" target="_blank">@keml_manager</a></p>
                    <p>–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: 9:00-23:00 –ú–°–ö</p>
                    <p class="age-warning">–ú—ã –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ–º –ø—Ä–æ–¥—É–∫—Ü–∏—é –ª–∏—Ü–∞–º –º–ª–∞–¥—à–µ 18 –ª–µ—Ç!</p>
                </div>
                <div>
                    <a href="https://t.me/keml_manager" target="_blank" class="telegram-btn">–°–≤—è–∑—å —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º</a>
                    <br><br>
                    <a href="https://t.me/Kemlshop" target="_blank" class="telegram-btn">–ù–∞—à Telegram –∫–∞–Ω–∞–ª</a>
                </div>
            </div>
        </div>
    </footer>

    <div id="age-modal" class="modal">
        <div class="modal-content">
            <h2>–í–∞–º –µ—Å—Ç—å 18 –ª–µ—Ç?</h2>
            <div class="modal-buttons">
                <button class="btn" onclick="confirmAge(true)">–î–∞</button>
                <button class="btn" style="background-color: #ef4444;" onclick="confirmAge(false)">–ù–µ—Ç</button>
            </div>
        </div>
    </div>

    <div id="disclaimer-modal" class="modal">
        <div class="modal-content">
            <h2>–í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
            <p>–í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–∞ —Å–∞–π—Ç–µ –Ω–æ—Å–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∫–ª–∞–º–æ–π. –ú—ã –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ–º –Ω–∏–∫–æ—Ç–∏–Ω–æ—Å–æ–¥–µ—Ä–∂–∞—â—É—é –ø—Ä–æ–¥—É–∫—Ü–∏—é –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–ª—è –µ—ë –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ.</p>
            <div class="modal-buttons">
                <button class="btn" onclick="closeDisclaimer()">–ü–æ–Ω—è—Ç–Ω–æ</button>
            </div>
        </div>
    </div>

    <div id="edit-product-modal" class="edit-modal">
        <div class="edit-modal-content">
            <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</h2>
            <form id="edit-product-form">
                <div class="form-group">
                    <label for="edit-product-name">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" id="edit-product-name" required>
                </div>
                <div class="form-group">
                    <label for="edit-product-category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select id="edit-product-category" required onchange="updateEditSubcategoryOptions()">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                        <option value="–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã">–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã</option>
                        <option value="–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞">–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞</option>
                        <option value="Pod-—Å–∏—Å—Ç–µ–º—ã">Pod-—Å–∏—Å—Ç–µ–º—ã</option>
                        <option value="–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏">–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏</option>
                        <option value="–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫">–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫</option>
                        <option value="–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –ø—Ä–æ—á–µ–µ">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –ø—Ä–æ—á–µ–µ</option>
                        <option value="Apple —Ç–µ—Ö–Ω–∏–∫–∞">Apple —Ç–µ—Ö–Ω–∏–∫–∞</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="edit-product-subcategory">–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select id="edit-product-subcategory">
                        <option value="">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="edit-product-price">–¶–µ–Ω–∞</label>
                    <input type="number" id="edit-product-price" required>
                </div>
                <div class="form-group">
                    <label for="edit-product-image">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                    <input type="text" id="edit-product-image" required>
                </div>
                <div class="form-group">
                    <label for="edit-product-description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="edit-product-description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                    <input type="text" id="edit-product-characteristics">
                </div>
                <div class="edit-modal-buttons">
                    <button type="button" class="btn btn-danger" onclick="closeEditModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <script>
        let products = [];
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let orders = JSON.parse(localStorage.getItem('orders')) || [];
        let reviews = JSON.parse(localStorage.getItem('reviews')) || [];
        let currentFilter = 'all';
        let currentSubcategory = 'all';
        let currentProduct = null;
        let editingProductId = null;
        let currentPage = 1;
        const itemsPerPage = 6;
        let allProducts = [];

        const telegramConfig = {
            token: '8284927236:AAEDASsSMU7GdWwqiSZIjZp0KdTLER49ZiE',
            chatIds: ['7745926883', '5368784136']
        };

        const subcategories = {
            '–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫': ['–ë–µ—Å—Ç–∞–±–∞—á–Ω—ã–π', '–¢–∞–±–∞—á–Ω—ã–π'],
            'Apple —Ç–µ—Ö–Ω–∏–∫–∞': ['iphones', 'macbooks', 'ipads', 'headphones']
        };

        const firebaseConfig = {
            apiKey: "AIzaSyDXSF1YCCCj4b5aTLOUNkAG-3O4Fq358vQ",
            authDomain: "keml-shop-b1a43.firebaseapp.com",
            projectId: "keml-shop-b1a43",
            storageBucket: "keml-shop-b1a43.firebasestorage.app",
            messagingSenderId: "682329458110",
            appId: "1:682329458110:web:093427e42aef1bc78ca5ef"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        document.addEventListener('DOMContentLoaded', async function() {
            console.log('–°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω');
            
            if (!localStorage.getItem('ageConfirmed')) {
                document.getElementById('age-modal').style.display = 'flex';
            }
            
            if (!localStorage.getItem('disclaimerShown')) {
                document.getElementById('disclaimer-modal').style.display = 'flex';
            }
            
            loadProducts();
            loadTelegramSettings();
            updateCartCount();
            updateMobileCartCount();
            
            document.getElementById('order-form').addEventListener('submit', handleOrderSubmit);
            
            const addProductForm = document.getElementById('add-product-form');
            if (addProductForm) {
                addProductForm.addEventListener('submit', addProduct);
            }
            
            const editProductForm = document.getElementById('edit-product-form');
            if (editProductForm) {
                editProductForm.addEventListener('submit', updateProduct);
            }
            
            const reviewForm = document.getElementById('add-review-form');
            if (reviewForm) {
                reviewForm.addEventListener('submit', addReview);
            }
            
            const telegramSettingsForm = document.getElementById('telegram-settings-form');
            if (telegramSettingsForm) {
                telegramSettingsForm.addEventListener('submit', saveTelegramSettings);
            }
            
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                    e.preventDefault();
                    showAdminPage();
                }
            });
            
            loadAdminStats();
        });

        function loadProducts() {
            database.ref('products').once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        allProducts = Object.keys(data).map(key => ({
                            id: key,
                            ...data[key]
                        }));
                    } else {
                        allProducts = [];
                    }
                    products = [...allProducts];
                    renderProducts();
                })
                .catch((error) => {
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤:", error);
                    allProducts = [...defaultProducts];
                    products = [...allProducts];
                    renderProducts();
                });
        }

        const defaultProducts = [
            {
                id: 1,
                name: "Elf Bar 6000 (–ú–∞–Ω–≥–æ-–õ—ë–¥)",
                category: "–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã",
                price: 1200,
                image: "https://images.unsplash.com/photo-1606756790138-261d2b21cd75?w=400&h=400&fit=crop",
                description: "–û–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —Å–∏–≥–∞—Ä–µ—Ç–∞ –Ω–∞ 6000 –∑–∞—Ç—è–∂–µ–∫",
                characteristics: ["6000 —Ç—è–≥", "–í–∫—É—Å: –ú–∞–Ω–≥–æ-–õ—ë–¥", "–ù–∏–∫–æ—Ç–∏–Ω: 20mg/ml", "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä: 650mAh"]
            },
            {
                id: 2,
                name: "HQD Cuvie Plus",
                category: "–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∏–≥–∞—Ä–µ—Ç—ã", 
                price: 900,
                image: "https://images.unsplash.com/photo-1571330735066-03aaa9429d89?w=400&h=400&fit=crop",
                description: "–ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è —Å–∏–≥–∞—Ä–µ—Ç–∞",
                characteristics: ["1200 —Ç—è–≥", "–í–∫—É—Å: –ö–ª—É–±–Ω–∏–∫–∞-–ë–∞–Ω–∞–Ω", "–ù–∏–∫–æ—Ç–∏–Ω: 20mg/ml"]
            },
            {
                id: 3,
                name: "–ñ–∏–¥–∫–æ—Å—Ç—å Monster Jam (–ö–∏–≤–∏)",
                category: "–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞",
                price: 600,
                image: "https://images.unsplash.com/photo-1583585633625-2de4d4f8b7b1?w=400&h=400&fit=crop",
                description: "–ü—Ä–µ–º–∏–∞–ª—å–Ω–∞—è –∂–∏–¥–∫–æ—Å—Ç—å –¥–ª—è –∑–∞–ø—Ä–∞–≤–∫–∏",
                characteristics: ["–û–±—ä–µ–º: 30ml", "–í–∫—É—Å: –ö–∏–≤–∏", "–ö—Ä–µ–ø–æ—Å—Ç—å: 3mg"]
            },
            {
                id: 4,
                name: "–ñ–∏–¥–∫–æ—Å—Ç—å VapeGo (–ú—è—Ç–∞)",
                category: "–ñ–∏–¥–∫–æ—Å—Ç–∏ –¥–ª—è –≤–µ–π–ø–∞",
                price: 550,
                image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=400&fit=crop",
                description: "–û—Å–≤–µ–∂–∞—é—â–∞—è –º–µ–Ω—Ç–æ–ª–æ–≤–∞—è –∂–∏–¥–∫–æ—Å—Ç—å",
                characteristics: ["–û–±—ä–µ–º: 30ml", "–í–∫—É—Å: –ú—è—Ç–∞", "–ö—Ä–µ–ø–æ—Å—Ç—å: 6mg"]
            },
            {
                id: 5,
                name: "Pod-—Å–∏—Å—Ç–µ–º–∞ Voopoo Drag",
                category: "Pod-—Å–∏—Å—Ç–µ–º—ã",
                price: 2500,
                image: "https://images.unsplash.com/photo-1610163388796-19d6e8c2c5b1?w=400&h=400&fit=crop",
                description: "–ú–æ—â–Ω–∞—è pod-—Å–∏—Å—Ç–µ–º–∞ —Å —Ä–µ–≥—É–ª–∏—Ä—É–µ–º–æ–π —Ç—è–≥–æ–π",
                characteristics: ["–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä: 1500mAh", "–¢–∏–ø: —Ä–µ–≥—É–ª–∏—Ä—É–µ–º—ã–π", "–ó–∞—Ä—è–¥–∫–∞: USB-C"]
            },
            {
                id: 6,
                name: "Uwell Caliburn G2",
                category: "Pod-—Å–∏—Å—Ç–µ–º—ã",
                price: 1800,
                image: "https://images.unsplash.com/photo-1542751371-adc38448a05e?w=400&h=400&fit=crop",
                description: "–ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –∏ –Ω–∞–¥–µ–∂–Ω–∞—è pod-—Å–∏—Å—Ç–µ–º–∞",
                characteristics: ["–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä: 750mAh", "–û–±—ä–µ–º –∫–∞—Ä—Ç—Ä–∏–¥–∂–∞: 2ml"]
            },
            {
                id: 7,
                name: "–ö–∞—Ä—Ç—Ä–∏–¥–∂ Voopoo PnP 0.3",
                category: "–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏",
                price: 300,
                image: "https://images.unsplash.com/photo-1563784462041-5f97ac9523dd?w=400&h=400&fit=crop",
                description: "–°–º–µ–Ω–Ω—ã–π –∫–∞—Ä—Ç—Ä–∏–¥–∂ –¥–ª—è Voopoo",
                characteristics: ["–°–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ: 0.3 –û–º", "–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: Voopoo PnP"]
            },
            {
                id: 8,
                name: "–ù–∞–±–æ—Ä –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π HQD",
                category: "–ö–∞—Ä—Ç—Ä–∏–¥–∂–∏",
                price: 800,
                image: "https://images.unsplash.com/photo-1570737543024-f5e0ea8f2f2c?w=400&h=400&fit=crop",
                description: "–ù–∞–±–æ—Ä –∏–∑ 3 —Å–º–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç—Ä–∏–¥–∂–µ–π",
                characteristics: ["–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 3 —à—Ç", "–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: HQD Cuvie"]
            },
            {
                id: 9,
                name: "Siberia Snus White Dry",
                category: "–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫",
                subcategory: "–¢–∞–±–∞—á–Ω—ã–π",
                price: 350,
                image: "https://images.unsplash.com/photo-1583585633625-2de4d4f8b7b1?w=400&h=400&fit=crop",
                description: "–ö—Ä–µ–ø–∫–∏–π –∂–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫ Siberia",
                characteristics: ["–ù–∏–∫–æ—Ç–∏–Ω: 43 –º–≥/–≥", "–í–µ—Å: 10 –≥", "–í–∫—É—Å: –ú—è—Ç–∞"]
            },
            {
                id: 10,
                name: "Lyft Freeze X-Strong",
                category: "–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫",
                subcategory: "–ë–µ—Å—Ç–∞–±–∞—á–Ω—ã–π",
                price: 400,
                image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=400&fit=crop",
                description: "–ë–µ–∑—Ç–∞–±–∞—á–Ω—ã–π –Ω–∏–∫–æ—Ç–∏–Ω–æ–≤—ã–π –ø–∞–∫–µ—Ç–∏–∫",
                characteristics: ["–ù–∏–∫–æ—Ç–∏–Ω: 16 –º–≥/–≥", "–í–µ—Å: 17 –≥", "–í–∫—É—Å: –ú—è—Ç–∞"]
            },
            {
                id: 11,
                name: "–ó–∞—Ä—è–¥–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Type-C",
                category: "–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –ø—Ä–æ—á–µ–µ",
                price: 500,
                image: "https://images.unsplash.com/photo-1586953208448-b95a79798f07?w=400&h=400&fit=crop",
                description: "–ë—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞ –¥–ª—è –≤–µ–π–ø–æ–≤",
                characteristics: ["–ú–æ—â–Ω–æ—Å—Ç—å: 18W", "–î–ª–∏–Ω–∞ –∫–∞–±–µ–ª—è: 1–º", "–¢–∏–ø: Type-C"]
            },
            {
                id: 12,
                name: "–ö–µ–π—Å –¥–ª—è –≤–µ–π–ø–∞",
                category: "–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –ø—Ä–æ—á–µ–µ",
                price: 800,
                image: "https://images.unsplash.com/photo-1592899677977-9c10ca588bbd?w=400&h=400&fit=crop",
                description: "–ó–∞—â–∏—Ç–Ω—ã–π –∫–µ–π—Å —Å –∫–∞—Ä–º–∞–Ω–æ–º –¥–ª—è –∂–∏–¥–∫–æ—Å—Ç–µ–π",
                characteristics: ["–ú–∞—Ç–µ—Ä–∏–∞–ª: EVA", "–†–∞–∑–º–µ—Ä: 15x8x5 —Å–º", "–¶–≤–µ—Ç: —á–µ—Ä–Ω—ã–π"]
            },
            {
                id: 101,
                name: "iPhone 15 Pro",
                category: "Apple —Ç–µ—Ö–Ω–∏–∫–∞",
                subcategory: "iphones",
                price: 120000,
                image: "https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=400&h=400&fit=crop",
                description: "–§–ª–∞–≥–º–∞–Ω—Å–∫–∏–π —Å–º–∞—Ä—Ç—Ñ–æ–Ω Apple —Å —Ç–∏—Ç–∞–Ω–æ–≤—ã–º –∫–æ—Ä–ø—É—Å–æ–º",
                characteristics: ["6.1\" –¥–∏—Å–ø–ª–µ–π", "A17 Pro —á–∏–ø", "48 –ú–ø –∫–∞–º–µ—Ä–∞", "128 –ì–ë –ø–∞–º—è—Ç–∏"]
            },
            {
                id: 102,
                name: "iPhone 15",
                category: "Apple —Ç–µ—Ö–Ω–∏–∫–∞",
                subcategory: "iphones",
                price: 90000,
                image: "https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=400&h=400&fit=crop",
                description: "–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å iPhone 15",
                characteristics: ["6.1\" –¥–∏—Å–ø–ª–µ–π", "A16 Bionic —á–∏–ø", "48 –ú–ø –∫–∞–º–µ—Ä–∞", "128 –ì–ë –ø–∞–º—è—Ç–∏"]
            },
            {
                id: 103,
                name: "MacBook Pro 14\"",
                category: "Apple —Ç–µ—Ö–Ω–∏–∫–∞",
                subcategory: "macbooks",
                price: 200000,
                image: "https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=400&h=400&fit=crop",
                description: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –Ω–æ—É—Ç–±—É–∫ Apple",
                characteristics: ["14\" Liquid Retina XDR", "M3 Pro —á–∏–ø", "18 –ì–ë RAM", "512 –ì–ë SSD"]
            },
            {
                id: 104,
                name: "MacBook Air 13\"",
                category: "Apple —Ç–µ—Ö–Ω–∏–∫–∞",
                subcategory: "macbooks",
                price: 120000,
                image: "https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=400&h=400&fit=crop",
                description: "–¢–æ–Ω–∫–∏–π –∏ –ª–µ–≥–∫–∏–π –Ω–æ—É—Ç–±—É–∫",
                characteristics: ["13.6\" Liquid Retina", "M2 —á–∏–ø", "8 –ì–ë RAM", "256 –ì–ë SSD"]
            },
            {
                id: 105,
                name: "iPad Pro 11\"",
                category: "Apple —Ç–µ—Ö–Ω–∏–∫–∞",
                subcategory: "ipads",
                price: 80000,
                image: "https://images.unsplash.com/photo-1544244016-0a4fffde374e?w=400&h=400&fit=crop",
                description: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω—à–µ—Ç",
                characteristics: ["11\" Liquid Retina", "M2 —á–∏–ø", "128 –ì–ë –ø–∞–º—è—Ç–∏", "Apple Pencil"]
            },
            {
                id: 106,
                name: "iPad Air",
                category: "Apple —Ç–µ—Ö–Ω–∏–∫–∞",
                subcategory: "ipads",
                price: 60000,
                image: "https://images.unsplash.com/photo-1544244016-0a4fffde374e?w=400&h=400&fit=crop",
                description: "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω—à–µ—Ç",
                characteristics: ["10.9\" Liquid Retina", "M1 —á–∏–ø", "64 –ì–ë –ø–∞–º—è—Ç–∏", "Apple Pencil"]
            },
            {
                id: 107,
                name: "AirPods Pro 2",
                category: "Apple —Ç–µ—Ö–Ω–∏–∫–∞",
                subcategory: "headphones",
                price: 25000,
                image: "https://images.unsplash.com/photo-1572569511254-d8f925fe2cbb?w=400&h=400&fit=crop",
                description: "–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏ —Å –∞–∫—Ç–∏–≤–Ω—ã–º —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º",
                characteristics: ["–ê–∫—Ç–∏–≤–Ω–æ–µ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ", "–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º", "6 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã", "–ó–∞—Ä—è–¥–Ω—ã–π –∫–µ–π—Å"]
            },
            {
                id: 108,
                name: "AirPods Max",
                category: "Apple —Ç–µ—Ö–Ω–∏–∫–∞",
                subcategory: "headphones",
                price: 60000,
                image: "https://images.unsplash.com/photo-1583394838336-acd977736f90?w=400&h=400&fit=crop",
                description: "–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏-–Ω–∞–∫–ª–∞–¥–Ω–∏–∫–∏",
                characteristics: ["–í—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–≤—É–∫", "–ê–∫—Ç–∏–≤–Ω–æ–µ —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ", "20 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã", "–¶–∏—Ñ—Ä–æ–≤–∞—è –∫–æ—Ä–æ–Ω–∞"]
            }
        ];

        function confirmAge(isAdult) {
            if (isAdult) {
                localStorage.setItem('ageConfirmed', 'true');
                document.getElementById('age-modal').style.display = 'none';
            } else {
                document.body.innerHTML = '<div style="display: flex; justify-content: center; align-items: center; height: 100vh; font-size: 2rem;">–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω</div>';
            }
        }

        function closeDisclaimer() {
            localStorage.setItem('disclaimerShown', 'true');
            document.getElementById('disclaimer-modal').style.display = 'none';
        }

        function showPage(pageName) {
            console.log('–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É:', pageName);
            
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            document.getElementById(pageName + '-page').classList.add('active');
            
            if (pageName === 'catalog') {
                currentPage = 1;
                renderProducts();
            } else if (pageName === 'cart') {
                renderCart();
            } else if (pageName === 'admin') {
                renderAdminProducts();
                renderOrders();
                loadAdminStats();
            } else if (pageName === 'apple-tech') {
                document.getElementById('apple-products-grid').innerHTML = '';
            }
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            if (window.innerWidth <= 768) {
                toggleMobileMenu();
            }
        }

        function goToCategory(category) {
            console.log('–ü–µ—Ä–µ—Ö–æ–¥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:', category);
            
            if (category === 'all') {
                products = [...allProducts];
            } else {
                products = allProducts.filter(p => p.category === category);
            }
            
            currentFilter = category;
            currentSubcategory = 'all';
            currentPage = 1;
            
            showPage('catalog');
            
            setTimeout(() => {
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.textContent.includes(category) || (category === 'all' && btn.textContent.includes('–í—Å–µ —Ç–æ–≤–∞—Ä—ã'))) {
                        btn.classList.add('active');
                    }
                });
                
                const subcategoriesDiv = document.getElementById('snus-subcategories');
                if (category === '–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫') {
                    subcategoriesDiv.classList.remove('hidden');
                } else {
                    subcategoriesDiv.classList.add('hidden');
                }
            }, 100);
        }

        function filterByCategory(category) {
            console.log('–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:', category);
            
            currentFilter = category;
            currentSubcategory = 'all';
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    if (btn.textContent.includes(category) || (category === 'all' && btn.textContent.includes('–í—Å–µ —Ç–æ–≤–∞—Ä—ã'))) {
                        btn.classList.add('active');
                    }
                });
            }
            
            if (category === 'all') {
                products = [...allProducts];
            } else {
                products = allProducts.filter(p => p.category === category);
            }
            
            console.log('–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤:', products.length);
            
            const subcategoriesDiv = document.getElementById('snus-subcategories');
            if (category === '–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫') {
                subcategoriesDiv.classList.remove('hidden');
            } else {
                subcategoriesDiv.classList.add('hidden');
            }
            
            currentPage = 1;
            renderProducts();
        }

        function filterBySubcategory(subcategory) {
            console.log('–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏:', subcategory);
            
            currentSubcategory = subcategory;
            
            document.querySelectorAll('.subcategory-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                document.querySelectorAll('.subcategory-btn').forEach(btn => {
                    if (btn.textContent.includes(subcategory) || (subcategory === 'all' && btn.textContent.includes('–í—Å–µ'))) {
                        btn.classList.add('active');
                    }
                });
            }
            
            if (subcategory === 'all') {
                products = allProducts.filter(p => p.category === '–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫');
            } else {
                products = allProducts.filter(p => 
                    p.category === '–ñ–µ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ç–∞–±–∞–∫' && p.subcategory === subcategory
                );
            }
            
            console.log('–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏:', products.length);
            
            currentPage = 1;
            renderProducts();
        }

        function searchProducts() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const filtered = allProducts.filter(p => 
                p.name.toLowerCase().includes(searchTerm) ||
                p.category.toLowerCase().includes(searchTerm) ||
                p.description.toLowerCase().includes(searchTerm)
            );
            products = filtered;
            currentPage = 1;
            renderProducts();
        }

        function clearSearch() {
            document.getElementById('search-input').value = '';
            products = [...allProducts];
            currentPage = 1;
            renderProducts();
        }

        function sortProducts() {
            const sortBy = document.getElementById('sort-select').value;
            let sorted = [...products];
            
            switch(sortBy) {
                case 'price-asc':
                    sorted.sort((a, b) => a.price - b.price);
                    break;
                case 'price-desc':
                    sorted.sort((a, b) => b.price - a.price);
                    break;
                case 'name':
                    sorted.sort((a, b) => a.name.localeCompare(b.name));
                    break;
            }
            
            products = sorted;
            currentPage = 1;
            renderProducts();
        }

        function renderProducts() {
            const grid = document.getElementById('products-grid');
            const totalPages = Math.ceil(products.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedProducts = products.slice(startIndex, endIndex);
            
            grid.innerHTML = paginatedProducts.map(product => `
                <div class="product-card" onclick="showProduct(${product.id})">
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <div class="product-price">${product.price} ‚ÇΩ</div>
                        <button class="btn" onclick="event.stopPropagation(); addToCart(${product.id})">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                    </div>
                </div>
            `).join('');
            
            renderPagination(totalPages);
        }

        function renderPagination(totalPages) {
            const pagination = document.getElementById('pagination');
            let html = '';
            
            if (totalPages > 1) {
                for (let i = 1; i <= totalPages; i++) {
                    html += `<button class="btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
                }
            }
            
            pagination.innerHTML = html;
        }

        function changePage(page) {
            currentPage = page;
            renderProducts();
        }

        function showProduct(productId) {
            currentProduct = products.find(p => p.id === productId);
            
            if (!currentProduct) {
                currentProduct = allProducts.find(p => p.id === productId);
            }
            
            if (!currentProduct) {
                showToast('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            const detailContainer = document.getElementById('product-detail');
            
            detailContainer.innerHTML = `
                <div>
                    <img src="${currentProduct.image}" alt="${currentProduct.name}" class="product-detail-image">
                </div>
                <div class="product-detail-info">
                    <h2>${currentProduct.name}</h2>
                    <div class="product-detail-price">${currentProduct.price} ‚ÇΩ</div>
                    <p class="product-description">${currentProduct.description}</p>
                    <ul class="characteristics">
                        ${currentProduct.characteristics.map(char => `<li>${char}</li>`).join('')}
                    </ul>
                    <div class="quantity-selector">
                        <button class="quantity-btn" onclick="changeQuantity(-1)">-</button>
                        <input type="number" id="product-quantity" class="quantity-input" value="1" min="1" max="99">
                        <button class="quantity-btn" onclick="changeQuantity(1)">+</button>
                    </div>
                    <button class="btn" onclick="addToCart(${currentProduct.id})">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
                </div>
            `;
            
            showPage('product');
            loadReviews(currentProduct.id);
        }

        function loadReviews(productId) {
            const productReviews = reviews.filter(r => r.productId === productId);
            const reviewsList = document.getElementById('reviews-list');
            
            reviewsList.innerHTML = productReviews.map(review => `
                <div class="review-item">
                    <div class="review-header">
                        <strong>${review.name}</strong>
                        <span class="review-rating">${'‚òÖ'.repeat(review.rating)}${'‚òÜ'.repeat(5-review.rating)}</span>
                    </div>
                    <p>${review.text}</p>
                </div>
            `).join('');
        }

        function addReview(event) {
            event.preventDefault();
            
            const productId = currentProduct.id;
            const name = document.getElementById('review-name').value;
            const rating = parseInt(document.getElementById('review-rating').value);
            const text = document.getElementById('review-text').value;
            
            const newReview = {
                id: Date.now(),
                productId,
                name,
                rating,
                text,
                date: new Date().toISOString()
            };
            
            reviews.push(newReview);
            localStorage.setItem('reviews', JSON.stringify(reviews));
            
            showToast('–û—Ç–∑—ã–≤ –¥–æ–±–∞–≤–ª–µ–Ω!');
            document.getElementById('add-review-form').reset();
            loadReviews(productId);
        }

        function changeQuantity(delta) {
            const input = document.getElementById('product-quantity');
            const newValue = parseInt(input.value) + delta;
            if (newValue >= 1 && newValue <= 99) {
                input.value = newValue;
            }
        }

        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            const quantity = document.getElementById('product-quantity') 
                ? parseInt(document.getElementById('product-quantity').value) 
                : 1;
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({
                    ...product,
                    quantity: quantity
                });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            updateMobileCartCount();
            showToast(`${product.name} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É`);
        }

        function updateCartCount() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').textContent = count;
        }

        function updateMobileCartCount() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('mobile-cart-count').textContent = count;
        }

        function renderCart() {
            const cartContainer = document.getElementById('cart-items');
            const totalContainer = document.getElementById('cart-total');
            
            if (cart.length === 0) {
                cartContainer.innerHTML = '<p style="text-align: center; color: #6c757d;">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
                totalContainer.innerHTML = '';
                return;
            }
            
            cartContainer.innerHTML = cart.map(item => `
                <div class="cart-item">
                    <img src="${item.image}" alt="${item.name}" class="cart-item-image">
                    <div class="cart-item-name">${item.name}</div>
                    <div class="cart-item-price">${item.price} ‚ÇΩ</div>
                    <div class="cart-quantity">
                        <button class="quantity-btn" onclick="updateCartQuantity(${item.id}, -1)">-</button>
                        <span>${item.quantity}</span>
                        <button class="quantity-btn" onclick="updateCartQuantity(${item.id}, 1)">+</button>
                    </div>
                    <div class="cart-item-total">${item.price * item.quantity} ‚ÇΩ</div>
                </div>
            `).join('');
            
            const total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
            totalContainer.innerHTML = `–ò—Ç–æ–≥–æ: ${total} ‚ÇΩ`;
        }

        function updateCartQuantity(productId, delta) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += delta;
                if (item.quantity <= 0) {
                    cart = cart.filter(item => item.id !== productId);
                }
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                updateMobileCartCount();
                renderCart();
            }
        }

        async function handleOrderSubmit(e) {
            e.preventDefault();
            
            const ageConfirmed = document.getElementById('age-confirm').checked;
            if (!ageConfirmed) {
                showToast('–í—ã –¥–æ–ª–∂–Ω—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, —á—Ç–æ –≤–∞–º –µ—Å—Ç—å 18 –ª–µ—Ç', 'error');
                return;
            }
            
            const total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
            
            if (total < 3500) {
                showToast('–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞ 3500‚ÇΩ');
                return;
            }
            
            const formData = {
                id: Date.now(),
                name: document.getElementById('name').value,
                telegram: document.getElementById('telegram').value,
                city: document.getElementById('city').value,
                comment: document.getElementById('comment').value,
                items: cart,
                total: total,
                status: 'new',
                date: new Date().toISOString()
            };
            
            try {
                orders.push(formData);
                localStorage.setItem('orders', JSON.stringify(orders));
                
                await sendTelegramNotification(formData);
                
                showToast('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω!');
                
                cart = [];
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                updateMobileCartCount();
                
                document.getElementById('order-form').reset();
                
                setTimeout(() => showPage('catalog'), 2000);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞:', error);
                showToast('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
            }
        }

        async function sendTelegramNotification(order) {
            let message = `üõí <b>–ù–û–í–´–ô –ó–ê–ö–ê–ó</b>\n\n`;
            message += `üìã <b>–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞:</b> #${order.id}\n`;
            message += `üë§ <b>–ö–ª–∏–µ–Ω—Ç:</b> ${order.name}\n`;
            message += `üì± <b>Telegram:</b> ${order.telegram}\n`;
            message += `üèôÔ∏è <b>–ì–æ—Ä–æ–¥:</b> ${order.city}\n`;
            message += `üí∞ <b>–°—É–º–º–∞:</b> ${order.total} ‚ÇΩ\n\n`;
            
            message += `üì¶ <b>–¢–æ–≤–∞—Ä—ã:</b>\n`;
            order.items.forEach(item => {
                message += `‚Ä¢ ${item.name} - ${item.quantity} —à—Ç. √ó ${item.price} ‚ÇΩ = ${item.price * item.quantity} ‚ÇΩ\n`;
            });
            
            if (order.comment) {
                message += `\nüí¨ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> ${order.comment}`;
            }
            
            message += `\n\n‚è∞ <b>–í—Ä–µ–º—è:</b> ${new Date(order.date).toLocaleString('ru-RU')}`;
            
            const keyboard = {
                inline_keyboard: [
                    [
                        { text: 'üìû –°–≤—è–∑–∞—Ç—å—Å—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º', url: `https://t.me/${order.telegram.replace('@', '')}` }
                    ],
                    [
                        { text: '‚úÖ –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π', callback_data: `processed_${order.id}` }
                    ]
                ]
            };
            
            for (const chatId of telegramConfig.chatIds) {
                try {
                    await sendTelegramMessage(chatId, message, keyboard);
                    
                    for (const item of order.items) {
                        if (item.image && item.image.startsWith('http')) {
                            await sendTelegramPhoto(chatId, item.image, `${item.name} - ${item.price} ‚ÇΩ`);
                        }
                    }
                } catch (error) {
                    console.error(`–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –¥–ª—è chatId ${chatId}:`, error);
                }
            }
            
            console.log('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Telegram');
        }

        async function sendTelegramMessage(chatId, text, replyMarkup = null) {
            const url = `https://api.telegram.org/bot${telegramConfig.token}/sendMessage`;
            
            const body = {
                chat_id: chatId,
                text: text,
                parse_mode: 'HTML',
                disable_web_page_preview: true
            };
            
            if (replyMarkup) {
                body.reply_markup = JSON.stringify(replyMarkup);
            }
            
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(body)
            });
            
            const result = await response.json();
            
            if (!result.ok) {
                throw new Error(`–û—à–∏–±–∫–∞ Telegram API: ${result.description}`);
            }
            
            return result;
        }

        async function sendTelegramPhoto(chatId, photoUrl, caption) {
            const url = `https://api.telegram.org/bot${telegramConfig.token}/sendPhoto`;
            
            const body = {
                chat_id: chatId,
                photo: photoUrl,
                caption: caption,
                parse_mode: 'HTML'
            };
            
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(body)
            });
            
            const result = await response.json();
            
            if (!result.ok) {
                throw new Error(`–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ: ${result.description}`);
            }
            
            return result;
        }

        function showAdminPage() {
            const password = prompt('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:');
            if (password.trim() === 'KemlKeml22HHTT97GRT') {
                showPage('admin');
            } else {
                showToast('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å');
            }
        }

        function renderAdminProducts() {
            const container = document.getElementById('admin-products-list');
            container.innerHTML = allProducts.map(product => `
                <div class="admin-product-card">
                    <h4>${product.name}</h4>
                    <p>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${product.category}</p>
                    ${product.subcategory ? `<p>–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è: ${product.subcategory}</p>` : ''}
                    <p>–¶–µ–Ω–∞: ${product.price} ‚ÇΩ</p>
                    <div class="admin-actions">
                        <button class="btn btn-warning" onclick="editProduct(${product.id})">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-danger" onclick="removeProduct(${product.id})">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                </div>
            `).join('');
        }

        function renderOrders() {
            const tbody = document.getElementById('orders-tbody');
            tbody.innerHTML = orders.map(order => `
                <tr>
                    <td>#${order.id}</td>
                    <td>${order.name}</td>
                    <td>${order.telegram}</td>
                    <td>${order.total} ‚ÇΩ</td>
                    <td>
                        <span class="status-badge status-${order.status}">
                            ${getStatusText(order.status)}
                        </span>
                    </td>
                    <td>
                        <select onchange="updateOrderStatus(${order.id}, this.value)">
                            <option value="new" ${order.status === 'new' ? 'selected' : ''}>–ù–æ–≤—ã–π</option>
                            <option value="processing" ${order.status === 'processing' ? 'selected' : ''}>–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</option>
                            <option value="completed" ${order.status === 'completed' ? 'selected' : ''}>–í—ã–ø–æ–ª–Ω–µ–Ω</option>
                            <option value="cancelled" ${order.status === 'cancelled' ? 'selected' : ''}>–û—Ç–º–µ–Ω–µ–Ω</option>
                        </select>
                    </td>
                </tr>
            `).join('');
        }

        function getStatusText(status) {
            const statusMap = {
                'new': '–ù–æ–≤—ã–π',
                'processing': '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ',
                'completed': '–í—ã–ø–æ–ª–Ω–µ–Ω',
                'cancelled': '–û—Ç–º–µ–Ω–µ–Ω'
            };
            return statusMap[status] || status;
        }

        function updateOrderStatus(orderId, newStatus) {
            const order = orders.find(o => o.id === orderId);
            if (order) {
                order.status = newStatus;
                localStorage.setItem('orders', JSON.stringify(orders));
                showToast('–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω');
                renderOrders();
                loadAdminStats();
            }
        }

        function updateSubcategoryOptions() {
            const category = document.getElementById('product-category').value;
            const subcategorySelect = document.getElementById('product-subcategory');
            
            subcategorySelect.innerHTML = '<option value="">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</option>';
            
            if (category && subcategories[category]) {
                subcategories[category].forEach(sub => {
                    const option = document.createElement('option');
                    option.value = sub;
                    option.textContent = sub;
                    subcategorySelect.appendChild(option);
                });
            }
        }

        function updateEditSubcategoryOptions() {
            const category = document.getElementById('edit-product-category').value;
            const subcategorySelect = document.getElementById('edit-product-subcategory');
            
            subcategorySelect.innerHTML = '<option value="">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</option>';
            
            if (category && subcategories[category]) {
                subcategories[category].forEach(sub => {
                    const option = document.createElement('option');
                    option.value = sub;
                    option.textContent = sub;
                    subcategorySelect.appendChild(option);
                });
            }
        }

        function addProduct(event) {
            event.preventDefault();
            
            const characteristics = document.getElementById('product-characteristics').value
                .split(',')
                .map(item => item.trim())
                .filter(item => item);
            
            const newProduct = {
                name: document.getElementById('product-name').value,
                category: document.getElementById('product-category').value,
                subcategory: document.getElementById('product-subcategory').value || null,
                price: parseInt(document.getElementById('product-price').value),
                image: document.getElementById('product-image').value,
                description: document.getElementById('product-description').value,
                characteristics: characteristics
            };
            
            const newProductRef = database.ref('products').push();
            newProductRef.set(newProduct)
                .then(() => {
                    showToast('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω');
                    document.getElementById('add-product-form').reset();
                    loadProducts();
                })
                .catch((error) => {
                    console.error("–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:", error);
                    showToast('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞');
                });
        }

        function editProduct(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) {
                showToast('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            editingProductId = productId;
            
            document.getElementById('edit-product-name').value = product.name;
            document.getElementById('edit-product-category').value = product.category;
            document.getElementById('edit-product-price').value = product.price;
            document.getElementById('edit-product-image').value = product.image;
            document.getElementById('edit-product-description').value = product.description || '';
            document.getElementById('edit-product-characteristics').value = product.characteristics ? product.characteristics.join(', ') : '';
            
            updateEditSubcategoryOptions();
            
            if (product.subcategory) {
                document.getElementById('edit-product-subcategory').value = product.subcategory;
            }
            
            document.getElementById('edit-product-modal').style.display = 'flex';
        }

        function updateProduct(event) {
            event.preventDefault();
            
            const characteristics = document.getElementById('edit-product-characteristics').value
                .split(',')
                .map(item => item.trim())
                .filter(item => item);
            
            const updatedProduct = {
                name: document.getElementById('edit-product-name').value,
                category: document.getElementById('edit-product-category').value,
                subcategory: document.getElementById('edit-product-subcategory').value || null,
                price: parseInt(document.getElementById('edit-product-price').value),
                image: document.getElementById('edit-product-image').value,
                description: document.getElementById('edit-product-description').value,
                characteristics: characteristics
            };
            
            database.ref('products/' + editingProductId).update(updatedProduct)
                .then(() => {
                    closeEditModal();
                    showToast('–¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω');
                    loadProducts();
                })
                .catch((error) => {
                    console.error("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:", error);
                    showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞');
                });
        }

        function closeEditModal() {
            document.getElementById('edit-product-modal').style.display = 'none';
            document.getElementById('edit-product-form').reset();
            editingProductId = null;
        }

        function removeProduct(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')) {
                database.ref('products/' + id).remove()
                    .then(() => {
                        showToast('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω');
                        loadProducts();
                    })
                    .catch((error) => {
                        console.error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:", error);
                        showToast('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞');
                    });
            }
        }

        function loadAdminStats() {
            const totalOrders = orders.length;
            const totalRevenue = orders.reduce((sum, order) => sum + order.total, 0);
            
            const productStats = {};
            orders.forEach(order => {
                order.items.forEach(item => {
                    if (!productStats[item.id]) {
                        productStats[item.id] = { name: item.name, count: 0 };
                    }
                    productStats[item.id].count += item.quantity;
                });
            });
            
            const popularProducts = Object.values(productStats)
                .sort((a, b) => b.count - a.count)
                .slice(0, 3);
            
            document.getElementById('total-orders').textContent = totalOrders;
            document.getElementById('total-revenue').textContent = `${totalRevenue} ‚ÇΩ`;
            
            const popularProductsHtml = popularProducts.map(item => 
                `<p>${item.name}: ${item.count} —à—Ç.</p>`
            ).join('');
            document.getElementById('popular-products').innerHTML = popularProductsHtml;
        }

        function loadTelegramSettings() {
            const saved = localStorage.getItem('telegramSettings');
            if (saved) {
                const settings = JSON.parse(saved);
                document.getElementById('telegram-token').value = settings.token || '';
                document.getElementById('telegram-chat-ids').value = settings.chatIds ? settings.chatIds.join(', ') : '';
            } else {
                document.getElementById('telegram-token').value = telegramConfig.token;
                document.getElementById('telegram-chat-ids').value = telegramConfig.chatIds.join(', ');
            }
        }

        function saveTelegramSettings(e) {
            e.preventDefault();
            
            const token = document.getElementById('telegram-token').value;
            const chatIdsString = document.getElementById('telegram-chat-ids').value;
            const chatIds = chatIdsString.split(',').map(id => id.trim()).filter(id => id);
            
            const settings = { token, chatIds };
            
            localStorage.setItem('telegramSettings', JSON.stringify(settings));
            
            telegramConfig.token = token;
            telegramConfig.chatIds = chatIds;
            
            showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }

        async function testTelegramNotification() {
            const testOrder = {
                id: Date.now(),
                name: '–¢–µ—Å—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç',
                telegram: '@test_user',
                city: '–¢–µ—Å—Ç–æ–≤—ã–π –≥–æ—Ä–æ–¥',
                comment: '–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑',
                items: [
                    { name: '–¢–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä', quantity: 1, price: 1000, image: 'https://images.unsplash.com/photo-1606756790138-261d2b21cd75?w=400&h=400&fit=crop' }
                ],
                total: 1000,
                date: new Date().toISOString()
            };
            
            try {
                await sendTelegramNotification(testOrder);
                showToast('–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:', error);
                showToast('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram.');
            }
        }

        function showAppleCategory(subcategory) {
            const appleProducts = allProducts.filter(p => 
                p.category === 'Apple —Ç–µ—Ö–Ω–∏–∫–∞' && p.subcategory === subcategory
            );
            
            renderAppleProducts(appleProducts);
        }

        function renderAppleProducts(products) {
            const grid = document.getElementById('apple-products-grid');
            
            if (products.length === 0) {
                grid.innerHTML = '<p style="text-align: center; color: #6c757d;">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                return;
            }
            
            grid.innerHTML = products.map(product => `
                <div class="product-card" onclick="showProduct(${product.id})">
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <div class="product-price">${product.price} ‚ÇΩ</div>
                        <button class="btn" onclick="event.stopPropagation(); addToCart(${product.id})">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                    </div>
                </div>
            `).join('');
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast show';
            
            if (type === 'error') {
                toast.classList.add('error');
            }
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            const burger = document.querySelector('.burger');
            
            mobileMenu.classList.toggle('active');
            burger.classList.toggle('active');
            
            // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–º –º–µ–Ω—é
            if (mobileMenu.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = 'auto';
            }
        }
    </script>
</body>
</html>